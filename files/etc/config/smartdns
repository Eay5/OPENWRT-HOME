config smartdns
	option enabled '1'
	option server_name 'smartdns'
	option port '5354'           # SmartDNS监听5354端口，避免冲突
	option tcp_server '1'        # 启用TCP服务
	option ipv6_server '1'       # 启用IPv6
	option dualstack_ip_selection '1'
	option prefetch_domain '1'   # 预取域名
	option serve_expired '1'     # 过期缓存服务
	option cache_size '10240'    # 10K缓存
	option cache_persist '1'     # 持久化缓存
	option cache_file '/tmp/smartdns.cache'
	option rr_ttl_min '300'
	option rr_ttl_max '3600'
	option force_AAAA_SOA '1'
	option speed_check_mode 'ping,tcp:443,tcp:80'
	
	# 国内上游DNS组
	list server '223.5.5.5:53 -group cn -exclude-default-group'
	list server '119.29.29.29:53 -group cn -exclude-default-group'
	list server '114.114.114.114:53 -group cn -exclude-default-group'
	list server 'https://dns.alidns.com/dns-query -group cn -exclude-default-group'
	
	# 国外上游DNS组（通过代理）
	list server '8.8.8.8:53 -group gfw -exclude-default-group'
	list server '1.1.1.1:53 -group gfw -exclude-default-group'
	list server 'https://1.1.1.1/dns-query -group gfw -exclude-default-group'
	list server 'tls://1.0.0.1:853 -group gfw -exclude-default-group'
	
	# 速度优化
	option speed_check '1'       # 启用测速
	option response_mode 'fastest-ip'  # 返回最快IP
	
	# 域名分流规则
	list domain_rules '/etc/smartdns/china-list.txt -nameserver cn -speed-check-mode none'
	list domain_rules 'gfwlist:/./ -nameserver gfw'
	
	# 本地域名
	list local_domain 'lan -nameserver cn'
	list local_domain 'local -nameserver cn'
